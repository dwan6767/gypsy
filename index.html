<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ESP Live Content</title>
</head>
<body>
<div id="espContent"></div>

<script>
async function loadESPContent() {
  const container = document.getElementById('espContent');
  try {
    // Try to fetch directly from the ESP URL (replace with your ESP IP/endpoint)
    const resp = await fetch('http://192.168.0.149'); 
    if (!resp.ok) throw new Error("ESP offline");
    const html = await resp.text();
    container.innerHTML = html;

    // Execute inline scripts
    container.querySelectorAll('script').forEach(oldScript => {
      const newScript = document.createElement('script');
      if (oldScript.src) newScript.src = oldScript.src;
      else newScript.textContent = oldScript.textContent;
      document.body.appendChild(newScript);
    });

  } catch (e) {
    container.innerHTML = ""; // clear if ESP offline
  }
}

// Refresh every 3 seconds
loadESPContent();
setInterval(loadESPContent, 3000);
</script>
</body>
</html>
